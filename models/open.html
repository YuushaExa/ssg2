<!DOCTYPE html>
<html>
<head>
    <title>DuckDuckGo Chat</title>
    <style>
        body {
            font-family: sans-serif;
        }
        #chatbox {
            width: 500px;
            height: 300px;
            border: 1px solid #ccc;
            overflow-y: scroll;
            padding: 10px;
        }
        #inputArea {
            margin-top: 10px;
        }
    </style>
</head>
<body>
    <h1>DuckDuckGo AI Chat</h1>

    <div id="chatbox"></div>

    <div id="inputArea">
        <select id="modelSelect">
            <option value="gpt-4o-mini">gpt-4o-mini</option>
            <option value="claude-3-haiku">claude-3-haiku</option>
            <option value="llama">llama</option>
            <option value="mixtral">mixtral</option>
        </select>
        <input type="text" id="messageInput" placeholder="Enter your message">
        <button id="sendButton">Send</button>
    </div>

    <script>
        const chatbox = document.getElementById('chatbox');
        const messageInput = document.getElementById('messageInput');
        const sendButton = document.getElementById('sendButton');
        const modelSelect = document.getElementById('modelSelect');

        let chatInitialized = false;

        async function initChat() {
            const response = await fetch('chatai2-psi.vercel.app/init', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ model: modelSelect.value })
            });

            if (response.ok) {
                chatInitialized = true;
                addToChatbox('System: Chat initialized!');
            } else {
                addToChatbox('Error initializing chat.');
            }
        }

        async function sendMessage() {
            if (!chatInitialized) {
                addToChatbox('Please initialize the chat first.');
                return;
            }

            const message = messageInput.value;
            messageInput.value = '';
            addToChatbox('You: ' + message);

            const response = await fetch('chatai2-psi.vercel.app/chat', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ message })
            });

            if (response.ok) {
                const text = await response.text();
                addToChatbox('AI: ' + text);
            } else {
                addToChatbox('Error sending message.');
            }
        }

        function addToChatbox(message) {
            chatbox.innerHTML += '<p>' + message + '</p>';
            chatbox.scrollTop = chatbox.scrollHeight;
        }

        sendButton.addEventListener('click', sendMessage);
        messageInput.addEventListener('keyup', function(event) {
            if (event.key === 'Enter') {
                sendMessage();
            }
        });

        modelSelect.addEventListener('change', () => {
            chatInitialized = false;
            chatbox.innerHTML = '';
            initChat();
        });

        initChat();
    </script>
</body>
</html>
